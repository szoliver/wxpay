(function(a,v){var t=function(d,g){if(d&&g){d=d.split(".");g=g.split(".");for(var k=Math.min(d.length,g.length),e=0,h=0;e<k&&0==(h=parseInt(d[e])-parseInt(g[e]));)e++;h=0!=h?h:d.length-g.length;return 0<h}return!1};a.fn.wxPay=function(d,g,k,e,h,l,m){var f=!1,q=a.extend({},{pid:"0",desc:"\u652f\u4ed8\u8d39\u7528"},k);k=function(){f=!0};"undefined"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",k,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",
k),document.attachEvent("onWeixinJSBridgeReady",k)):f=!0;var u=function(b){var c=0;b=b.toString();try{c+=b.split(".")[1].length}catch(n){}try{c+=(void 0).length}catch(n){}return Number(b.replace(".",""))*Number("100".replace(".",""))/Math.pow(10,c)};if(a.isEmptyObject(g)&&!a.fn.wxPay.Debug)a(this).click(function(){alert("\u7528\u6237\u4fe1\u606f\u9519\u8bef\uff0c\u65e0\u6cd5\u8c03\u7528\u5fae\u4fe1\u652f\u4ed8")}),a(this).click();else{var r=a.fn.wxPay.WxVersion();if(t(r,"8.0.3")||a.fn.wxPay.Debug)if(""==
q.desc)q.desc="\u5907\u6ce8\u4e0d\u80fd\u4e3a\u7a7a";else{var p=!0;a(this).click(function(){if(p)if(p=!1,f||a.fn.wxPay.Debug){var b=0;if("function"===typeof e){b=e();if(isNaN(b)){p=!0;return}b=0<parseFloat(b)?u(b).toFixed(0):b}"number"!==typeof e||isNaN(e)||(b=u(e).toFixed(0));0!=b&&a.post(d,{openid:g,tfee:b,body:q.desc,pid:q.pid,param:a.fn.wxPay.OrderParam,sp_billno:a.fn.wxPay.OrderCode},function(c){"ERROR"==c.paySign?"function"===typeof l&&l(c.package):WeixinJSBridge.invoke("getBrandWCPayRequest",
{appId:c.appId,timeStamp:c.timeStamp,nonceStr:c.nonceStr,"package":c.package,signType:"MD5",paySign:c.paySign},function(n){"get_brand_wcpay_request:ok"==n.err_msg?"function"===typeof h&&h({fee:c.fee,ordercode:c.ordercode}):"get_brand_wcpay_request:fail"==n.err_msg?"function"===typeof l&&l(n.err_desc):"function"===typeof m&&m(c.payNo)})},"json");setTimeout(function(){p=!0},800)}else p=!0})}else a(this).click(function(){alert("\u8bf7\u5b89\u88c5\u5e76\u5347\u7ea7\u5fae\u4fe1APP\uff0c\u7248\u672c>=8.0.3\uff0c\u5f53\u524d\uff1a"+
("0"==r?"\u975e\u5fae\u4fe1\u6d4f\u89c8\u5668":r))}),a(this).click()}};a.fn.SelectAddress=function(d,g,k,e,h,l,m){t(ver,"8.0.3")||a.fn.wxPay.Debug?a(this).click(function(){WeixinJSBridge.invoke("editAddress",{appId:d,scope:"jsapi_address",signType:"sha1",addrSign:g,timeStamp:k,nonceStr:e},function(f){"edit_address:ok"==f.err_msg?a.isFunction(h)&&(a.fn.wxPay.SelectedAddr=f.proviceFirstStageName+" "+f.addressCitySecondStageName+" "+f.addressCountiesThirdStageName+" "+f.addressDetailInfo,h(f)):"edit_address:fail"==
f.err_msg?a.isFunction(l)&&l(f.err_desc):a.isFunction(m)&&m("\u7528\u6237\u53d6\u6d88")})}):alert("\u8bf7\u5b89\u88c5\u5e76\u5347\u7ea7\u5fae\u4fe1APP\uff0c\u7248\u672c>=8.0.3\uff0c\u5f53\u524d\uff1a"+("0"==ver?"\u975e\u5fae\u4fe1\u6d4f\u89c8\u5668":ver))};a.fn.wxPay.SelectedAddr="";a.fn.wxPay.OrderParam="";a.fn.wxPay.OrderCode="";a.fn.wxPay.Debug=!1;a.fn.wxPay.WxVersion=function(){var d=navigator.userAgent.match(/MicroMessenger\/([\d\.]+)/i);return d?d[1]:"0"}})(jQuery,window);
